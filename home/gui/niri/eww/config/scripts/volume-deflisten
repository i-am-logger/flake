#!/usr/bin/env bash

# Event-driven volume deflisten script - only updates when volume actually changes

# Get initial volume
get_volume() {
    pamixer --get-volume 2>/dev/null || echo "0"
}

# Output initial volume
get_volume

# Listen for volume change events using pactl subscribe
pactl subscribe 2>/dev/null | while read -r event; do
    # Only respond to sink (output device) events
    if echo "$event" | grep -q "Event 'change' on sink"; then
        get_volume
    fi
done
